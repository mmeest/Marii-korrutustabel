<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marii jagamine</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <style>
        *{
            text-align: center;
        } 
        table tr th {
            width: 33%;
        }
        #header{
            visibility: visible;
        }
        #body{
            visibility: hidden;
        }
        #output{
            font-size: 3em;
            font-weight: bold;
        }
        #green{
            background-color: rgb(64, 204, 64);
        }
        #yellow{
            background-color: rgb(243, 243, 66);
        }
        #red{
            background-color: rgb(212, 87, 87);
        }
    </style>
</head>
<body>
    <div id="header"><br>
        <p>
            <label for="max">Jagamine 1 kuni </label>
            <input type="text" placeholder="5" value="5" id="biggest">
        </p>
        <button type="button" class="btn btn-primary" onclick="begin()">Alusta</button>
    </div>
    <div id="body" class="hidden">
        <p>
            <h2 id="kt">Marii jagamine 1 kuni 5</h2>
        </p>
        <div id="math">
            <p>
                <div id="output">Jagamistehe</div>
                <input type="text" name="" id="answer">
            </p>
            <p>
                <h3 id="remaining">Arvutusi jäänud 100</h3>
            </p>
        </div>
        <p>
            <h3 id="points">Punktid kokku 0</h3>
        </p>
        <p>
            <button class="btn btn-secondary" onclick="window.location.reload()">Uus mäng</button>
        </p>
        <p>
            <table class="table">
                <tr>
                    <th id="v1">
                        Õige vastus (+1 p)
                    </th>
                    <th id="v2">
                        Vale vstus (-2 p)
                    </th>
                    <th id="v3">
                        Üle 3 sek. (-3 p)
                    </th>
                </tr>
                <tr>
                    <td>
                        <div id="green">

                        </div>
                    </td>
                    <td>
                        <div id="yellow">

                        </div>
                    </td>
                    <td>
                        <div id="red">

                        </div>
                    </td>
                </tr>
            </table>
        </p>
    </div>

    <script>
        var a, b, c, d, e = 0
        var vo = 0
        var vv = 0
        var vm = 0
        var x = 100
        var biggest 
        var timeout = false
        var timer
        var myVar

        function begin(){
            var biggest = parseInt(document.getElementById("biggest").value)
            document.getElementById("header").style.visibility = "hidden";
            document.getElementById("body").style.visibility = "visible";
            output()
        }

        function output(){
            biggest = document.getElementById("biggest").value
            document.getElementById("kt").innerHTML = "Marii jagamine 1 kuni " + biggest
            a = Math.floor(Math.random() * biggest) + 1
            b = Math.floor(Math.random() * biggest) + 1
            c = a * b
            console.log(vo + " " + vv + " " + vm)

            document.getElementById("output").innerHTML = c + ' &divide; &equiv; ' + b            
        }

        var input = document.getElementById("answer");
            // Enter key event
        input.addEventListener("keyup", function(event, timer) {
            if (event.keyCode === 13) {
                event.preventDefault();
            d = parseInt(document.getElementById("answer").value)

            console.log(vo + " " + vv + " " + vm)
            clearTimeout(myVar);
            myVar = setTimeout(function(){ timeout = true; }, 3000);
            
            if(d == a && timeout == false){
                e += 1
                document.getElementById("green").innerHTML += c + ' / ' + b + ' = ' + d + '; '
                document.getElementById("points").innerHTML = "Punktid kokku " + e
                vo += 1
                document.getElementById("v1").innerHTML = "Õige vastus (+1 p) kokku " + vo
            }else if (d != a && timeout == false){
                e -= 2
                document.getElementById("yellow").innerHTML += c + ' / ' + b + ' = ' + d + '; '
                document.getElementById("points").innerHTML = "Punktid kokku " + e
                vv += 1
                document.getElementById("v2").innerHTML = "Vale vstus (-2 p) kokku " + vv
            }else{
                e -= 3
                document.getElementById("red").innerHTML += c + ' / ' + b + ' = ' + d + '; '
                document.getElementById("points").innerHTML = "Punktid kokku " + e
                vm += 1
                document.getElementById("v3").innerHTML = "Üle 3 sek. (-3 p) kokku " + vm
            }
            setTimeout("timeout = false", 0)
            clearTimeout(timer)
            timeout = false

            output(biggest)
            x -= 1
            if(x == 0){
                document.getElementById("math").style.display = "none"
            }
            document.getElementById("remaining").innerHTML = "Arvutusi jäänud " + x
            document.getElementById("answer").value = ""
            }
        });

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
</body>
</html>